Running base/roses-init with no systems loaded
base/roses-init -verbose -testRun

Item script checks starting
item/create checks starting
item/create -creator 246 -item WEAPON:ITEM_WEAPON_SWORD_SHORT -material INORGANIC:STEEL (Should succeed and create a steel short sword)

item/create -creator 246 -item WEAPON:ITEM_WEAPON_SWORD_SHORT -material INORGANIC:RUBY -dur 50 (Should succeed and create a ruby short sword and then remove it 50 ticks later)

Pausing run_test.lua for 75 in-game ticks
Resuming run_test.lua
PASSED: item/create
item/create checks finished

item/equip and item/unequip checks starting
item/equip -item 486 -unit 246 -bodyPart GRASP -bodyType Flag -mode Weapon (Should succeed and move item into inventory of unit carrying in hand)
C:\Users\miles\Desktop\DwarfFortress\44X\hack\lua\utils.lua:595: error: invalid arg: 7: bodyType
stack traceback:
	[C]: in function 'error'
	C:\Users\miles\Desktop\DwarfFortress\44X\hack\lua\utils.lua:595: in function 'utils.processArgs'
	...les\Desktop\DwarfFortress\44X/raw/scripts/item/equip.lua:49: in local 'script_code'
	...sers\miles\Desktop\DwarfFortress\44X\hack\lua\dfhack.lua:562: in function 'dfhack.run_script_with_env'
	(...tail calls...)
	[C]: in function 'dfhack.saferesume'
	...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:24: in upvalue 'do_resume'
	...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:62: in function <...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:51>
	[C]: in ?

item/unequip -item 486 -unit 246 (Should succeed and move item from inventory to ground at unit location)

item/unequip -item ALL -unit 246 (Should succeed and remove all items that unit has in inventory)

FAILED: item/equip and item/unequip
Short sword not equipped on unit
item/equip and item/unequip checks finished

item/material-change checks starting
item/material-change -item 487 -mat CREATURE_MAT:DWARF:BRAIN (Should succeed and change the material of item to dwarf brain)

item/material-change -unit 247 -equipment ALL -mat INORGANIC:ADAMANTINE -dur 50 (Should succeed and change the material of all units inventory to adamantine for 50 ticks)

Pausing run_test.lua for 75 in-game ticks
Resuming run_test.lua
item/material-change -item 487 -mat INORGANIC:STEEL (Should succeed and change the material of item to steel and create a persistent table for the item to track changes)

PASSED: item/material-change
item/material-change checks finished

item/quality-change checks starting
item/quality-change -item 488 -quality 5 (Should succeed and change the quality of the item to masterwork and track the change in the persistent item table)

item/quality-change -unit 247 -equipment ALL -quality 5 -dur 50 (Should succeed and change the quality of all units inventory to masterwork for 50 ticks)

Pausing run_test.lua for 75 in-game ticks
Resuming run_test.lua
item/quality-change -type WEAPON:ITEM_WEAPON_SWORD_SHORT -upgrade (Should succeed and increase the quality of all short swords on the map by 1)
C:\Users\miles\Desktop\DwarfFortress\44X\hack\lua\utils.lua:595: error: invalid arg: 1: type
stack traceback:
	[C]: in function 'error'
	C:\Users\miles\Desktop\DwarfFortress\44X\hack\lua\utils.lua:595: in function 'utils.processArgs'
	...op\DwarfFortress\44X/raw/scripts/item/quality-change.lua:57: in local 'script_code'
	...sers\miles\Desktop\DwarfFortress\44X\hack\lua\dfhack.lua:562: in function 'dfhack.run_script_with_env'
	(...tail calls...)
	[C]: in function 'dfhack.saferesume'
	...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:24: in upvalue 'do_resume'
	...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:62: in function <...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:51>
	[C]: in ?

FAILED: item/quality-change
Not all short swords increased in quality
item/quality-change checks finished

item/subtype-change checks starting
item/subtype-change -item 489 -subtype ITEM_WEAPON_SWORD_LONG (Should succeed and change the short sword to a long sword and track the change in the persistent item table)

item/subtype-change -unit 247 -equipment PANTS -subtype ITEM_PANTS_GREAVES -dur 50 (Should succeed and change the pants the unit is wearing into greaves for 50 ticks)

Pausing run_test.lua for 75 in-game ticks
Resuming run_test.lua
item/subtype-change -type WEAPON:ITEM_WEAPON_PICK -subtype ITEM_WEAPON_SWORD_SHORT (Should succeed and change all picks on the map into short swords)
C:\Users\miles\Desktop\DwarfFortress\44X\hack\lua\utils.lua:595: error: invalid arg: 1: type
stack traceback:
	[C]: in function 'error'
	C:\Users\miles\Desktop\DwarfFortress\44X\hack\lua\utils.lua:595: in function 'utils.processArgs'
	...op\DwarfFortress\44X/raw/scripts/item/subtype-change.lua:54: in local 'script_code'
	...sers\miles\Desktop\DwarfFortress\44X\hack\lua\dfhack.lua:562: in function 'dfhack.run_script_with_env'
	(...tail calls...)
	[C]: in function 'dfhack.saferesume'
	...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:24: in upvalue 'do_resume'
	...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:62: in function <...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:51>
	[C]: in ?

FAILED: item/subtype-change
Failed to turn all picks into short swords
Failed to turn all picks into short swords
item/subtype-change checks finished

item/projectile checks starting
item/projectile -unitSource 246 -unitTarget 247 -item AMMO:ITEM_AMMO_BOLT -mat INORGANIC:IRON (Should succeed and create an iron bolt shooting from source to target)
...Desktop\DwarfFortress\44X/raw/scripts/functions/item.lua:377: attempt to index a nil value (global 'creator')
stack traceback:
	...Desktop\DwarfFortress\44X/raw/scripts/functions/item.lua:377: in field 'create'
	...esktop\DwarfFortress\44X/raw/scripts/item/projectile.lua:152: in local 'script_code'
	...sers\miles\Desktop\DwarfFortress\44X\hack\lua\dfhack.lua:562: in function 'dfhack.run_script_with_env'
	(...tail calls...)
	[C]: in function 'dfhack.saferesume'
	...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:24: in upvalue 'do_resume'
	...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:62: in function <...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:51>
	[C]: in ?

item/projectile -unitSource 246 -type Falling -item AMMO:ITEM_AMMO_BOLT -mat INORGANIC:IRON -height 5 -number 10 (Should succeed and create 10 iron bolt falling from 5 above the source)
...Desktop\DwarfFortress\44X/raw/scripts/functions/item.lua:377: attempt to index a nil value (global 'creator')
stack traceback:
	...Desktop\DwarfFortress\44X/raw/scripts/functions/item.lua:377: in field 'create'
	...esktop\DwarfFortress\44X/raw/scripts/item/projectile.lua:152: in local 'script_code'
	...sers\miles\Desktop\DwarfFortress\44X\hack\lua\dfhack.lua:562: in function 'dfhack.run_script_with_env'
	(...tail calls...)
	[C]: in function 'dfhack.saferesume'
	...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:24: in upvalue 'do_resume'
	...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:62: in function <...\miles\Desktop\DwarfFortress\44X\hack\lua\gui\script.lua:51>
	[C]: in ?

FAILED: item/projectile
Failed to create 1 shooting projectile
Failed to create 10 falling projectiles
item/projectile checks finished
Item script checks finished
